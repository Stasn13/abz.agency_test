$(document).ready(function(){function e(){$("#photo-error").attr("hidden",!1)}fetch("http://504080.com/api/v1/directories/enquiry-types",{method:"GET"}).then(function(e){e.json().then(function(e){for(let r=0;r<e.data.length;r++){var t=$('<option value="'+e.data[r].name+'">'+e.data[r].name+"</option>");$("#enquiry-type").append(t)}$("#enquiry-type").select2({placeholder:" ",minimumResultsForSearch:1/0})})}),$("#enquiry-type").change(function(){"Other"===$(this).val()?$("#other-hidden").removeAttr("hidden"):$("#other-hidden").attr("hidden",!0)}),$("#add-photo").change(function(){}),$(".required-name").blur(function(){""===$(".required-name").val()?$(".error-name").removeAttr("hidden"):$(".error-name").attr("hidden",!0)}),$(".required-email").blur(function(){var e;e=this.value,/^[0-9a-z-\.]+\@[0-9a-z-]{2,}\.[a-z]{2,}$/i.test(e)?$(".error-email").attr("hidden",!0):$(".error-email").removeAttr("hidden")}),$(".required-subject").blur(function(){""===$(".required-subject").val()?$(".error-subject").removeAttr("hidden"):$(".error-subject").attr("hidden",!0)}),$(".required-description").blur(function(){""===$(".required-description").val()?$(".error-description").removeAttr("hidden"):$(".error-description").attr("hidden",!0)}),$("#add-photo").change(function(){switch(this.files[0].type){case"image/jpg":case"image/png":case"image/jpeg":break;default:e(),testPhoto=!1}var t=$("#img-preview"),r=new FileReader,n=new Image,i=this.files[0];r.readAsDataURL(i),r.onload=function(){n.onload=function(){this.width<=300&&this.height<=300&&i.size<=5242880?(t.attr("src",r.result),$(".img-preview").removeAttr("hidden")):(e(),testPhoto=!1)},n.src=r.result}}),$("#description").keyup(function(){$("#count").text("("+$(this).val().length+"/1000)")}),$("#submit-form").click(function(e){e.preventDefault();var t=new FormData,r={department:1,description:$("#description").val(),email:$("#email").val(),enquiry_type:$("#enquiry-type").val(),subject:$("#subject").val(),user_name:$("#name").val()};for(var n in r)t.append(n,r[n]);""!==$("#enquiry-type-other").val&&(t.delete("enquiry-type"),t.append("enquiry-type",$("#enquiry-type-other").val())),document.getElementById("add-photo").files[0]&&t.append("file",document.getElementById("add-photo").files[0]),fetch("http://504080.com/api/v1/support",{method:"POST",body:t}).then(function(e){200===e.status?($(".modal").css("display","flex"),console.log(t)):422===e.status&&$(".error").removeAttr("hidden")})}),$(".modal-window-button").click(function(){$(".modal").css("display","none")})});